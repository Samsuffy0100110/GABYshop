{% extends 'base.html.twig' %}

{% block title %}Valider ma commande |
	{{ parent() }}
{% endblock %}

{% block body %}
	<div class="container">
		<h2 class="mt-5">Je passe ma commande</h2>
		<p>Choisissez vos préférences avant de passer votre commande</p>
		<hr>
		<div class="row">
			<div class="col-md-6">
				{% set formHTML  %}
				{{ form_start(form,{action: path('order_recap') }) }}
				{{ form_label(form.addresses, 'Adresse de livraison') }}
				<a href="{{ path('account_address') }}">Ajouter une nouvelle adresse</a>
				{{ form_end(form) }}
				{% endset %}
				{{ formHTML|replace({'[br]':'<br>'})|raw }}
			</div>
			<div class="col-md-6">
				<div class="text-center">
					<h4>Récapitulatif de votre commande</h4>
				</div>
				<div class="bg-light p-3 rounded-shadow">
					{% for key, attribut in cart %}
						<div class="row {% if key > 0 %}mt-2{% endif %}">
							<div class="col-auto">
								<img src="{{ ('/images/products/' ~ attribut.attribut.product.image0)|imagine_filter('Thumbnail_products_cart') }}" class="rounded" alt="{{ attribut.attribut.product.name }}">
							</div>
							<div class="col-auto my-auto">
								<p class="fw-bold">{{ attribut.attribut.product.name }}</p><br>
								<p>{{ attribut.attribut.name }}</p>
							</div>
							<div class="col-auto my-auto">
								<p>x
									{{ attribut.quantity }}</p>
							</div>
							<div class="col-auto">
							<p>prix HT</p>
								<p>{{ (((attribut.attribut.product.price / 100) - ((attribut.attribut.product.price / 100 ) * (attribut.attribut.product.taxe.percent / 100 ))) * attribut.quantity)| number_format(2, ',', '.') }}&euro;</p>
							</div>
							<div class="col-auto">
							<p>prix TTC</p>
								<p>{{ ((attribut.attribut.product.price * attribut.quantity) / 100) | number_format(2, ',', '.') }}&euro;</p>
						</div>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>
{% endblock %}
