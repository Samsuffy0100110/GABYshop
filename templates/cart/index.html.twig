{% extends 'base.html.twig' %}

{% block title %}Mon panier | {{ parent() }}
{% endblock %}

{% block body %}
<div class="container p-5">
	<h1>Mon panier</h1>
	<p>
    Retrouver l'ensemble des produits que vous avez ajouté à votre panier, <strong>attention votre panier à une durée de 20 minutes maximum.</strong> <br>
            {% if cart|length > 0 %}<a class="mt-3 fw-bold btn btn-light" href="{{ path('home') }}">Continuer mes achats</a>{% endif %}
    </p>
    <div class="text-end">
        <a href="{{ path('cart_remove') }}" class="btn btn-danger m-2">Vider mon panier</a>
    </div>
    {% if cart|length > 0 %}

        <table class="table table-striped borde rounded shadow">
            <thead>
                <tr>
                    <th scope="col" colspan="2">Produit</th>
                    <th scope="col">Quantité</th>
                    <th scope="col">Prix</th>
                    <th scope="col" colspan="2">Total</th>
                </tr>
            </thead>
            <tbody>
                {% set total = 0 %}
                {% set nbProducts = 0 %}
                {% for attribut in cart %}
                    <tr>
                        <td>
                            <img src="{{ ('/images/products/' ~ attribut.attribut.product.image0)|imagine_filter('Thumbnail_products_cart') }}" class="rounded" alt="{{ attribut.attribut.product.name }}">
                        </td>
                        <td>
                            {{ attribut.attribut.product.name }}<br>
                            {{ attribut.attribut.name }}
                        </td>
                        <td class="no-style-hover">
                        <a href="{{ path('cart_decrease',{ id:attribut.attribut.id }) }}" class="text-decoration-none">
                            <img src="{{ ('/images/others/minus.png') }}" alt="supprimer un produit" height="20">
                        </a>
                        &nbsp;{{ attribut.quantity }}&nbsp;
                            {# {% if (attribut.quantity < attribut.attribut.quantity) and (attribut.quantity >= 1) %}
                                <a href="{{ path('cart_increase',{ id:attribut.attribut.id }) }}" class="text-decoration-none">
                                    <img src="{{ ('/images/others/plus.png') }}" alt="ajouter un produit" height="20">
                                </a>
                            {% else %}
                                'stock épuisé'
                            {% endif %} #}
                            <a href="{{ path('cart_add',{ id:attribut.attribut.id }) }}" >
                                <img src="{{ ('/images/others/plus.png') }}" alt="ajouter un produit" height="20">
                            </a>
                        </td>
                        <td>{{ (attribut.attribut.product.price /100)| number_format(2, ',', '.') }} &euro;</td>
                        <td>{{ ((attribut.attribut.product.price * attribut.quantity) / 100) | number_format(2, ',', '.') }}	&euro;</td>
                        <td>
                            <a href="{{ path('cart_delete', { id:attribut.attribut.id }) }}">
                                <img src="{{ ('/images/others/trash-can.png') }}" alt="supprimer mon produit" height="20">
                            </a>
                        </td>
                    </tr>
                    {% set total = total + ((attribut.attribut.product.price * attribut.quantity) / 100) %}
                    {% set nbProducts = nbProducts + attribut.quantity %}
                {% endfor %}
            </tbody>
        </table>
        <div class="text-end">
            <b>Nombre de produits : {{ nbProducts }}</b>
            <br>
            <b>Total de mon panier : {{ total | number_format(2, ',', '.') }} &euro;</b>
            <br>
            <a href="#" class="btn btn-success mt-2">Valider mon panier</a>            
        </div>
    {% else %}
        <hr>
        <p>Votre panier est vide.</p>
    {% endif %}
</div>
{% endblock %}
